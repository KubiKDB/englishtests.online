<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Language Test</title>
    <!-- Google Analytics (GA4) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-K2TNG0KVK8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-K2TNG0KVK8');
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px auto;
            max-width: 800px;
            padding: 10px;
            padding-top: 70px; /* Add padding to accommodate fixed header */
        }
        .question {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .passage {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #444;
            border-radius: 5px;
            background-color: #e3f2fd;
        }
        .submit-btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        .submit-btn:hover {
            background-color: #45a049;
        }
        .result {
            margin-top: 20px;
            font-weight: bold;
        }
        /* Add these styles to your body and html elements */
        html, body {
          height: 100%;
          margin: 0;
        }

        /* Main content area that will grow to push footer down */
        main {
          flex: 1 0 auto; /* This makes the main content expand */
        }

        /* Header styling for horizontal alignment */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            margin-bottom: 20px;
            background-color: white;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            max-width: 800px;
            margin-right: auto;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        /* Center title and adjust width */
        .header h2 {
            margin: 0;
            text-align: center;
            flex-grow: 1;
        }

        /* Home button */
        .home-button {
            width: 44px;
            height: 44px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
            z-index: 20;
            border-radius: 50%;
            transition: background-color 0.3s;
            text-decoration: none;
        }

        .home-button:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }

        /* New SVG Home Icon with primary color */
        .home-icon {
            width: 24px;
            height: 24px;
            fill: #3498DB;
            transition: fill 0.3s;
        }

        .home-button:hover .home-icon {
            fill: #2980b9;
        }

        
    /* Footer Styling */
    .footer {
        background-color: #ffffff;
        color: #000000;
        text-align: bottom;
        padding: 5px;
        margin-top: 50px;
/*         width: 100%; */
        max-width: 800px;
        flex-shrink: 0;
    }
    
    .footer-content {
        max-width: 600px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    .footer p {
        margin: 5px 0;
        font-size: 1.1em;
        font-weight: 300;
    }
    
    .footer-email {
        color: #3498db; /* blue color for the email link */
        text-decoration: none;
        transition: color 0.3s ease;
    }
    
    .footer-email:hover {
        color: #2980b9; /* darker blue on hover */
        text-decoration: underline;
    }
    
    .footer-spacer {
        height: 30px;
        width: 100%;
    }
    
    .footer-made {
        margin-top: 10px;
    }
    
    .footer-maker {
        font-size: 1.3em;
    }
    </style>
</head>
<body>
    <div class="header">
        <a href="javascript:history.back()" class="home-button">
            <svg width="25.6" height="22.4" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M0.292893 7.29289C-0.097631 7.68342 -0.0976311 8.31658 0.292893 8.70711L6.65685 15.0711C7.04738 15.4616 7.68054 15.4616 8.07107 15.0711C8.46159 14.6805 8.46159 14.0474 8.07107 13.6569L2.41421 8L8.07107 2.34314C8.46159 1.95262 8.46159 1.31946 8.07107 0.928931C7.68054 0.538407 7.04738 0.538407 6.65685 0.928931L0.292893 7.29289ZM18 7L1 7L1 9L18 9L18 7Z" fill="#3498DB"/>
            </svg>
        </a>
        <h2>English Language Test</h2>
        <a href="https://englishtests.online/" class="home-button">
            <svg class="home-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                <path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/>
            </svg>
        </a>
    </div>
    <div id="passageContainer"></div> <form id="quizForm"></form>
    <button type="submit" class="submit-btn" id="submitBtn">Submit</button>
    <div id="result" class="result"></div>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const levelValue = urlParams.get('level');
        const iValue = parseInt(levelValue, 10);
        const diffValue = urlParams.get('diff');

        document.querySelector('h2').textContent = `${diffValue} — test ${iValue}`;

        fetch(`json/${diffValue}/test${iValue}.json`) // Path to your JSON file
            .then(response => {
                console.log("Response Status:", response.status);
                return response.json();
            })
            .then(data => {
                console.log("JSON Data:", data);

                const passageText = data.passage;
                const questions = data.questions;

                const form = document.getElementById("quizForm");
                let passageAdded = false; // Initialize passageAdded to false

                questions.forEach((q, index) => {
                    // Add passage before question 41
                    if (q.id === 41 && !passageAdded) {
                        const passageDiv = document.createElement("div");
                        passageDiv.classList.add("passage");
                        passageDiv.innerHTML = `<strong>Reading Passage:</strong><br>${passageText}`;
                        form.appendChild(passageDiv); // Append passage to the form *before* question 41
                        passageAdded = true; // Set passageAdded to true so it's not added again
                    }

                    console.log("Processing Question:", q.id);

                    const questionDiv = document.createElement("div");
                    questionDiv.classList.add("question");

                    const questionText = document.createElement("p");
                    questionText.innerHTML = `<strong>${index + 1}. ${q.question}</strong>`;
                    questionDiv.appendChild(questionText);

                    Object.entries(q.options).forEach(([key, value]) => {
                        const input = document.createElement("input");
                        input.type = "radio";
                        input.name = `q${q.id}`;
                        input.value = key;

                        const label = document.createElement("label");
                        label.innerHTML = ` ${key}) ${value}<br>`;

                        questionDiv.appendChild(input);
                        questionDiv.appendChild(label);
                    });

                    form.appendChild(questionDiv);
                });

                document.getElementById("submitBtn").addEventListener("click", function(event) {
                    event.preventDefault();

                    let score = 0;
                    let total = questions.length;
                    let resultText = "<h3>Results:</h3>";

                    questions.forEach(q => {
                        let selected = document.querySelector(`input[name="q${q.id}"]:checked`);
                        if (selected) {
                            if (selected.value === q.correct_answer) {
                                score++;
                                resultText += `<p>Question ${q.id}: Correct ✅</p>`;
                            } else {
                                resultText += `<p>Question ${q.id}: Incorrect ❌ (Correct: ${q.correct_answer})</p>`;
                            }
                        } else {
                            resultText += `<p>Question ${q.id}: No answer selected ❌ (Correct: ${q.correct_answer})</p>`;
                        }
                    });

                    resultText += `<p><strong>Your Score: ${score} / ${total}</strong></p>`;
                    document.getElementById("result").innerHTML = resultText;
                    // Save the score in localStorage
                    // Get the current test level from URL
                    const urlParams = new URLSearchParams(window.location.search);
                    const testLevel = urlParams.get('level');
                    const diffLevel = urlParams.get('diff');
                    
                    // Create a unique key for this test
                    const testKey = `${diffLevel}-test-${testLevel}`;
                    
                    // Save the score
                    localStorage.setItem(testKey, score);
                });
            })
            .catch(error => {
                console.error('Error loading questions:', error);
                console.error("Fetch Error Details:", error);
            });
    </script>
    <footer class="footer">
    <div class="footer-content">
        <p>© Copyright 2025</p>
        <p><a href="mailto:info@englishtests.online" class="footer-email">info@englishtests.online</a></p>
        <p>All rights reserved</p>        
        <p class="footer-made">Made by <a href="https://play.google.com/store/apps/dev?id=5093525609695433503" class="footer-email">KubiKDB</a></p>
    </div>
    </footer>
</body>
</html>
